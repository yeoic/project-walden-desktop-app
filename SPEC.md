# 집중모드 기능 명세서

**버전**: 1.0.0
**최종 수정일**: 2024.12.31
**플랫폼**: macOS

---

## 1. 개요

### 1.1 목적
사용자가 집중이 필요한 시간 동안 특정 앱들의 실행을 차단하여 업무/학습 효율성을 높이는 macOS용 데스크톱 애플리케이션

### 1.2 대상 사용자
- 집중력 향상이 필요한 직장인/학생
- SNS, 메신저 등 방해 앱을 스스로 제어하기 어려운 사용자

---

## 2. 기능 상세

### 2.1 앱 차단 기능

#### 2.1.1 앱 선택
| 항목 | 설명 |
|------|------|
| 기능 | 차단할 앱 선택 및 관리 |
| 동작 | `+ 추가` 버튼 클릭 시 설치된 앱 + 실행 중인 앱 목록 표시 |
| UI | 체크박스 리스트, 검색 필터 지원 |
| 저장 | 선택된 앱 목록은 `~/.focus_mode_config.json`에 자동 저장 |

#### 2.1.2 앱 목록 표시
| 항목 | 설명 |
|------|------|
| 형태 | 블록(태그) 형태로 표시 |
| 동작 | 각 블록의 X 버튼으로 개별 삭제 가능 |
| 초기화 | `초기화` 버튼으로 전체 삭제 |

#### 2.1.3 제외 앱
다음 앱들은 시스템 안정성을 위해 목록에서 제외:
- 시스템 앱: Finder, Dock, WindowServer, SystemUIServer 등
- 유틸리티: Terminal, Console, Disk Utility 등
- 자기 자신: 집중모드, Python, python3

---

### 2.2 시간 설정 기능

#### 2.2.1 빠른 설정 버튼
| 버튼 | 동작 |
|------|------|
| +5분 | 현재 시간에 5분 추가 |
| +10분 | 현재 시간에 10분 추가 |
| +30분 | 현재 시간에 30분 추가 |
| +1시간 | 현재 시간에 1시간 추가 |
| -5분 | 현재 시간에서 5분 감소 |
| -10분 | 현재 시간에서 10분 감소 |
| -30분 | 현재 시간에서 30분 감소 |
| 초기화 | 설정 시간 0으로 리셋 |

**특징**: 누적 방식으로 동작 (예: +10분 3번 클릭 = 30분)

#### 2.2.2 직접 입력
| 항목 | 설명 |
|------|------|
| 입력 필드 | 시간, 분 별도 입력 |
| 동작 | `설정` 버튼 클릭 시 현재 값에 누적 |
| 제한 | 최소 1분 이상 입력 필요 |

#### 2.2.3 시간 표시
| 표시 항목 | 설명 |
|------|------|
| 현재 시간 | 실시간 시계 표시 (HH:MM:SS) |
| 총 집중시간 | 설정된 집중 시간 표시 |
| 종료 시간 | 현재 시간 + 집중 시간 계산하여 표시 |

---

### 2.3 감시 기능

#### 2.3.1 감시 시작
| 조건 | 설명 |
|------|------|
| 선행 조건 | 차단 앱 1개 이상 선택, 집중 시간 1분 이상 설정 |
| 동작 | 백그라운드 스레드에서 1초마다 프로세스 검사 |
| 차단 방식 | `psutil.Process.kill()`로 프로세스 강제 종료 |

#### 2.3.2 차단 알림
차단된 앱 실행 시도 시 macOS 네이티브 다이얼로그 표시:
```
[앱이름] 차단됨!

1분 1초가 아깝다!
하던 일을 마무리 하세요!
```

#### 2.3.3 감시 중지
| 항목 | 설명 |
|------|------|
| 수동 중지 | `감시 중지` 버튼 클릭 |
| 자동 중지 | 설정된 종료 시간 도달 시 |
| 중지 후 | 설정된 집중시간은 유지됨 (재시작 가능) |

---

### 2.4 슈퍼 감시 모드

#### 2.4.1 개요
한번 시작하면 설정된 시간이 끝날 때까지 중지할 수 없는 강화된 감시 모드

#### 2.4.2 활성화
| 항목 | 설명 |
|------|------|
| UI | 체크박스 `슈퍼 감시 (중지 불가)` |
| 확인 | 체크 시 경고 다이얼로그 표시 |

#### 2.4.3 확인 다이얼로그
```
슈퍼 감시를 체크하는 순간부터
집중 시작 후, 중간에 중지하는게 불가능합니다.

반드시 설정한 집중시간을 마무리해야
다시 차단한 앱을 사용할 수 있습니다.

[예, 알겠습니다]  [취소]
```

#### 2.4.4 동작
| 상태 | 설명 |
|------|------|
| 활성화 시 | `감시 중지` 버튼 비활성화 |
| 상태 표시 | "슈퍼 감시 중! (중지 불가)" 빨간색 표시 |
| 종료 조건 | 설정된 시간 완료 시에만 자동 종료 |

---

### 2.5 단일 인스턴스

#### 2.5.1 동작 방식
| 항목 | 설명 |
|------|------|
| 구현 | 소켓 기반 (포트 47200) |
| 첫 실행 | 소켓 서버 생성 후 정상 실행 |
| 중복 실행 | 기존 인스턴스에 신호 전송 후 새 인스턴스 종료 |
| 효과 | 기존 창이 최상위로 활성화됨 |

---

### 2.6 설정 저장

#### 2.6.1 저장 위치
`~/.focus_mode_config.json`

#### 2.6.2 저장 항목
```json
{
  "blocked_apps": ["앱이름1", "앱이름2", ...]
}
```

#### 2.6.3 저장 시점
- 앱 선택 완료 시
- 개별 앱 삭제 시
- 전체 초기화 시
- 앱 종료 시

---

## 3. UI 구성요소

### 3.1 메인 윈도우
| 속성 | 값 |
|------|------|
| 타이틀 | "맥북 집중 모드" |
| 크기 조절 | 불가 (자동 크기 조절) |
| 위치 | 화면 중앙 |

### 3.2 버튼 스타일
| 버튼 | 배경색 | 텍스트색 |
|------|------|------|
| 시작 (활성) | #4CAF50 (녹색) | 흰색 |
| 중지 (활성) | #FF5555 (빨간색) | 흰색 |
| 비활성 | #CCCCCC (회색) | 회색 |

### 3.3 색상 코드
| 용도 | 색상 |
|------|------|
| 현재 시간 표시 | #00FF00 (밝은 녹색) |
| 슈퍼 감시 모드 | #FF5555 (빨간색) |
| 앱 블록 배경 | #E3F2FD (연한 파랑) |
| 앱 블록 텍스트 | #1976D2 (파랑) |

---

## 4. 기술 사양

### 4.1 의존성
| 라이브러리 | 용도 |
|------|------|
| tkinter | GUI 프레임워크 |
| psutil | 프로세스 관리 |
| subprocess | 시스템 명령 실행 |
| threading | 백그라운드 감시 |
| socket | 단일 인스턴스 |
| json | 설정 저장/로드 |
| unicodedata | 한글 유니코드 정규화 |

### 4.2 시스템 요구사항
| 항목 | 요구사항 |
|------|------|
| OS | macOS 10.14+ |
| Python | 3.8+ (소스 실행 시) |
| 권한 | 접근성 권한 (앱 차단용) |

### 4.3 유니코드 처리
macOS는 한글을 NFD(분해형)로 반환하므로, 앱 이름 비교 시 NFC(조합형)으로 정규화 처리

---

## 5. 에러 처리

### 5.1 앱 차단 실패
| 원인 | 처리 |
|------|------|
| 프로세스 미존재 | 무시 (NoSuchProcess) |
| 권한 부족 | 무시 (AccessDenied) |

### 5.2 설정 파일
| 상황 | 처리 |
|------|------|
| 파일 없음 | 기본값 사용 (빈 목록) |
| 파싱 오류 | 기본값 사용 |
| 저장 실패 | 무시 |

---

## 6. 향후 개선 가능 사항

- [ ] 웹사이트 차단 기능
- [ ] 통계/리포트 기능
- [ ] 예약 기능 (특정 시간에 자동 시작)
- [ ] 화이트리스트 모드 (선택 앱만 허용)
- [ ] 메뉴바 아이콘 지원
- [ ] Windows/Linux 지원

---

## 7. 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|------|
| 1.0.0 | 2024.12.31 | 최초 릴리즈 |
